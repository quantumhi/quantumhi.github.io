<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Basketball League Standings</title>

  <!-- Font + CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>üèÄ Haverford Intramural Basketball Standings</h1>
    <p class="subtitle">2025 | Updated Weekly</p>
  </header>

  <div class="search-bar">
    <input type="text" id="searchInput" aria-label="Search team" placeholder="Search team..." />
  </div>

  <table id="standingsTable" aria-describedby="caption-standings">
    <caption id="caption-standings">Regular season standings. Sorted by wins (auto).</caption>
    <thead>
      <tr>
        <th scope="col">Rank</th>
        <th scope="col">Team</th>
        <th scope="col">Wins</th>
        <th scope="col">Losses</th>
        <th scope="col">Win %</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>1</td><td class="team-name">Globogym</td><td>12</td><td>2</td><td class="pct">0.857</td></tr>
      <tr><td>2</td><td class="team-name">Iron Wolves</td><td>10</td><td>4</td><td class="pct">0.714</td></tr>
      <tr><td>3</td><td class="team-name">Shadow Falcons</td><td>8</td><td>6</td><td class="pct">0.571</td></tr>
      <tr><td>4</td><td class="team-name">Steel Titans</td><td>6</td><td>8</td><td class="pct">0.429</td></tr>
      <tr><td>5</td><td class="team-name">Blaze Lions</td><td>4</td><td>10</td><td class="pct">0.286</td></tr>
      <tr><td>6</td><td class="team-name">Storm Sharks</td><td>3</td><td>11</td><td class="pct">0.214</td></tr>
    </tbody>
  </table>

  <footer>
    ¬© HCIBB 2025
  </footer>

  <script>
    // Debounce helper
    function debounce(fn, wait = 150) {
      let t;
      return (...args) => {
        clearTimeout(t);
        t = setTimeout(() => fn.apply(this, args), wait);
      };
    }

    function filterTeams(input) {
      const value = input.trim().toLowerCase();
      const rows = document.querySelectorAll('#standingsTable tbody tr');
      rows.forEach(row => {
        const team = row.querySelector('.team-name').textContent.toLowerCase();
        row.style.display = team.includes(value) ? '' : 'none';
      });
    }

    // Auto-sort + add roster links
    window.addEventListener('DOMContentLoaded', () => {
      const tbody = document.querySelector('#standingsTable tbody');
      const rows = Array.from(tbody.querySelectorAll('tr'));

      // Sort by wins descending
      rows.sort((a, b) => {
        const aw = parseInt(a.children[2].textContent, 10) || 0;
        const bw = parseInt(b.children[2].textContent, 10) || 0;
        return bw - aw;
      });

      rows.forEach((r, i) => {
        // Update rank + win %
        r.children[0].textContent = i + 1;
        const wins = parseInt(r.children[2].textContent, 10) || 0;
        const losses = parseInt(r.children[3].textContent, 10) || 0;
        const pct = (wins + losses) > 0 ? (wins / (wins + losses)) : 0;
        r.children[4].textContent = pct.toFixed(3);

        // Create roster link
        const teamCell = r.querySelector('.team-name');
        const teamName = teamCell.textContent.trim();
        const pageName = teamName.toLowerCase().replace(/\s+/g, '');
        const rosterUrl = `rosters/${pageName}.html`;

        // Make cell clickable
        teamCell.innerHTML = `<a href="${rosterUrl}" class="team-link">${teamName}</a>`;

        // Append row back
        tbody.appendChild(r);
      });

      // Search handler
      const input = document.getElementById('searchInput');
      input.addEventListener('input', debounce(() => filterTeams(input.value), 120));
    });
  </script>
</body>
</html>
